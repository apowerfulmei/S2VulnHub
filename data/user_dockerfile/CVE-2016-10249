FROM ubuntu:16.04
RUN sed -i "s@http://.*archive.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
RUN sed -i "s@http://.*security.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
ARG DEBIAN_FRONTEND=noninteractive
RUN apt update && apt install -y iputils-ping wget git vim build-essential cmake unzip
RUN apt install -y autoconf pkg-config libtool
WORKDIR /root
RUN git clone https://github.com/jasper-software/jasper
WORKDIR /root/jasper
RUN git checkout 105dfe9ef11a971c3ca1ba0af653528af631c46a
RUN echo -n YXV0b3JlY29uZiAtaQpDRkxBR1M9Jy1zdGQ9Yzk5IC1mc2FuaXRpemU9YWRkcmVzcyAtZnNhbml0aXplPXVuZGVmaW5lZCcgLi9jb25maWd1cmUKbWFrZSAtag== | base64 -d > build.sh
RUN wget https://github.com/asarubbo/poc/raw/master/00001-jasper-heapoverflow-jpc_dec_tiledecode
RUN echo -n Li9zcmMvYXBwbC9pbWdpbmZvIC1mIDAwMDAxLWphc3Blci1oZWFwb3ZlcmZsb3ctanBjX2RlY190aWxlZGVjb2Rl | base64 -d > trigger.sh
RUN bash build.sh
CMD ["/bin/bash"]
