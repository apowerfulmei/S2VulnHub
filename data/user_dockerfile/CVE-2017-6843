FROM ubuntu:16.04
RUN sed -i "s@http://.*archive.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
RUN sed -i "s@http://.*security.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
ARG DEBIAN_FRONTEND=noninteractive
RUN apt update && apt install -y iputils-ping wget git vim build-essential cmake unzip
RUN apt install -y libfreetype6-dev libfontconfig1-dev pkg-config
WORKDIR /root
RUN wget https://github.com/c8ef/VulPackpages/raw/main/podofo.zip
RUN unzip podofo.zip
WORKDIR /root/podofo
RUN echo -n bWtkaXIgYnVpbGQKY2QgYnVpbGQKY21ha2UgLi4gLURDTUFLRV9CVUlMRF9UWVBFPURlYnVnIC1EQ01BS0VfQ1hYX0ZMQUdTPSctZnNhbml0aXplPWFkZHJlc3MnCm1ha2UgLWo= | base64 -d > build.sh
RUN wget https://github.com/asarubbo/poc/raw/master/00170-podofo-heapoverflow-PoDoFo-PdfTokenizer-GetNextToken
RUN echo -n Li9idWlsZC90b29scy9wb2RvZm9jb2xvci9wb2RvZm9jb2xvciBkdW1teSAwMDE3MC1wb2RvZm8taGVhcG92ZXJmbG93LVBvRG9Gby1QZGZUb2tlbml6ZXItR2V0TmV4dFRva2VuIGZvbw== | base64 -d > trigger.sh
RUN bash build.sh || true
CMD ["bash", "trigger.sh"]
