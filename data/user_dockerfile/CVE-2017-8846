FROM ubuntu:16.04
RUN sed -i "s@http://.*archive.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
RUN sed -i "s@http://.*security.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
ARG DEBIAN_FRONTEND=noninteractive
RUN apt update && apt install -y iputils-ping wget git vim build-essential cmake unzip
RUN apt install -y autoconf libtool coreutils libz-dev libbz2-dev liblzo2-dev liblz4-dev automake gcc
WORKDIR /root
RUN git clone https://github.com/ckolivas/lrzip
WORKDIR /root/lrzip
RUN git checkout 9de7ccbd33ca679a03f35008cccb5abfb1bf36b9
RUN echo -n Li9hdXRvZ2VuLnNoCkNGTEFHUz0nLXN0ZD1jOTkgLWZzYW5pdGl6ZT1hZGRyZXNzJyBMREZMQUdTPSctbGFzYW4nIC4vY29uZmlndXJlCm1ha2UgLWogYG5wcm9jYAptYWtlIGluc3RhbGw= | base64 -d > build.sh
RUN wget https://github.com/asarubbo/poc/raw/master/00233-lrzip-UAF-read_stream
RUN echo -n Li9scnppcCAtdCAwMDIzMy1scnppcC1VQUYtcmVhZF9zdHJlYW0= | base64 -d > trigger.sh
RUN bash build.sh || true
CMD ["/bin/bash"]
