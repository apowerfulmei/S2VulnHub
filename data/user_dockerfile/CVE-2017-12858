FROM ubuntu:16.04
RUN sed -i "s@http://.*archive.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
RUN sed -i "s@http://.*security.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
ARG DEBIAN_FRONTEND=noninteractive
RUN apt update && apt install -y iputils-ping wget git vim build-essential cmake unzip
RUN apt install -y pkg-config zlib1g-dev libbz2-dev liblzma-dev
WORKDIR /root
RUN wget https://github.com/Yeeyooo/libzip-1.2.0/raw/main/libzip-1.2.0.tar.gz
RUN tar -xzvf libzip-1.2.0.tar.gz
WORKDIR /root/libzip-1.2.0
RUN echo -n Q0ZMQUdTPSctZyAtTzAgLWZzYW5pdGl6ZT1hZGRyZXNzJyAuL2NvbmZpZ3VyZQptYWtlIC1q | base64 -d > build.sh
RUN wget https://github.com/mudongliang/LinuxFlaw/raw/master/CVE-2017-12858/poc.zip
RUN echo -n Li9zcmMvemlwdG9vbCAuL3BvYy56aXAgY2F0IC4vaW5kZXg= | base64 -d > trigger.sh
RUN bash build.sh || true
CMD ["/bin/bash"]
