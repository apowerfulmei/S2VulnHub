FROM ubuntu:14.04
RUN sed -i "s@http://.*archive.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
RUN sed -i "s@http://.*security.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
ARG DEBIAN_FRONTEND=noninteractive
RUN apt update && apt install -y iputils-ping wget git vim build-essential cmake unzip
RUN apt install -y autoconf pkg-config
WORKDIR /root
RUN git clone https://github.com/axiomatic-systems/bento4
WORKDIR /root/bento4
RUN git checkout 3f2ad0b82d59aa5995d027df64b2964ebcf59e10
RUN echo -n bWtkaXIgYnVpbGQKY2QgYnVpbGQKY21ha2UgLi4gLURDTUFLRV9DX0ZMQUdTPSctZnNhbml0aXplPWFkZHJlc3MnIC1EQ01BS0VfQ1hYX0ZMQUdTPSctZnNhbml0aXplPWFkZHJlc3MnCm1ha2UgLWo= | base64 -d > build.sh
RUN wget https://github.com/asarubbo/poc/raw/master/00342-bento4-heapoverflow-AP4_DataBuffer_SetData
RUN echo -n Li9idWlsZC9tcDQyYWFjIDAwMzQyLWJlbnRvNC1oZWFwb3ZlcmZsb3ctQVA0X0RhdGFCdWZmZXJfU2V0RGF0YSBvdXQuYWFj | base64 -d > poc.sh
CMD ["/bin/bash"]
