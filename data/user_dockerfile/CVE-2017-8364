FROM ubuntu:16.04
RUN sed -i "s@http://.*archive.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
RUN sed -i "s@http://.*security.ubuntu.com@http://mirrors.ustc.edu.cn/@g" /etc/apt/sources.list
ARG DEBIAN_FRONTEND=noninteractive
RUN apt update && apt install -y iputils-ping wget git vim build-essential cmake unzip
RUN apt install -y automake autoconf pkg-config libtool libbz2-dev
WORKDIR /root
RUN wget https://rzip.samba.org/ftp/rzip/rzip-2.1.tar.gz
RUN tar -xzvf rzip-2.1.tar.gz
WORKDIR /root/rzip-2.1
RUN echo -n Q0ZMQUdTPSctc3RkPWM5OSAtZnNhbml0aXplPWFkZHJlc3MnIC4vY29uZmlndXJlCm1ha2UgLWo= | base64 -d > build.sh
RUN wget https://github.com/asarubbo/poc/raw/master/00277-rzip-heap-overflow-read_buf.rz
RUN echo -n Li9yemlwIC1rIC1mIC1kIDAwMjc3LXJ6aXAtaGVhcC1vdmVyZmxvdy1yZWFkX2J1Zi5yeg== | base64 -d > trigger.sh
RUN bash build.sh || true
CMD ["/bin/bash"]
